# .github/workflows/build-exe.yml
name: Build Windows EXE

on:
  push:
    branches: [ main ]
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pyinstaller pywin32
    
    - name: Build executable
      run: |
        pyinstaller --onefile --windowed --name="HWP-PDFë³€í™˜ê¸°" --hidden-import=tkinter --hidden-import=tkinter.messagebox --hidden-import=tkinter.filedialog --hidden-import=win32com.client --hidden-import=pythoncom main.py
    
    - name: Create release files
      run: |
        mkdir release
        copy "dist\HWP-PDFë³€í™˜ê¸°.exe" "release\"
        echo "HWP to PDF ë³€í™˜ê¸° v1.0" > release\README.txt
        echo. >> release\README.txt
        echo "ì‚¬ìš©ë²•:" >> release\README.txt
        echo "1. HWP-PDFë³€í™˜ê¸°.exe ì‹¤í–‰" >> release\README.txt
        echo "2. HWP íŒŒì¼ ì„ íƒ" >> release\README.txt
        echo "3. ë³€í™˜ ì‹œì‘" >> release\README.txt
        echo. >> release\README.txt
        echo "ì£¼ì˜: í•œê¸€ í”„ë¡œê·¸ë¨ì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤." >> release\README.txt
      shell: cmd
    
    - name: Upload build artifact
      uses: actions/upload-artifact@v4
      with:
        name: hwp-pdf-converter-v1.0
        path: release/
        retention-days: 30
    
    - name: Create Release (on tag push)
      if: startsWith(github.ref, 'refs/tags/')
      uses: softprops/action-gh-release@v2
      with:
        files: release/*
        body: |
          ## HWP to PDF ë³€í™˜ê¸°
          
          ### ğŸš€ ê¸°ëŠ¥
          - HWP íŒŒì¼ì„ PDFë¡œ ì¼ê´„ ë³€í™˜
          - ì‚¬ìš©ì ì¹œí™”ì  GUI
          - ì‹¤ì‹œê°„ ì§„í–‰ë¥  í‘œì‹œ
          - ì•ˆì •ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬
          
          ### ğŸ“‹ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
          - Windows 10/11
          - í•œê¸€ê³¼ì»´í“¨í„° "í•œê¸€" í”„ë¡œê·¸ë¨
          
          ### ğŸ“– ì‚¬ìš©ë²•
          1. `HWP-PDFë³€í™˜ê¸°.exe` ì‹¤í–‰
          2. HWP íŒŒì¼ë“¤ ì„ íƒ
          3. ì¶œë ¥ í´ë” ì§€ì • (ì„ íƒì‚¬í•­)
          4. ë³€í™˜ ì‹œì‘
          
          ### âš ï¸ ì£¼ì˜ì‚¬í•­
          - í•œê¸€ í”„ë¡œê·¸ë¨ì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤
          - ë³€í™˜ ì¤‘ì—ëŠ” í•œê¸€ í”„ë¡œê·¸ë¨ì´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}